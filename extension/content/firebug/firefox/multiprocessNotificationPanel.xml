<?xml version="1.0"?>
<!-- See license.txt for terms of usage -->

<bindings xmlns="http://www.mozilla.org/xbl"
    xmlns:xbl="http://www.mozilla.org/xbl"
    xmlns:xul="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
    xmlns:html="http://www.w3.org/1999/xhtml">

<binding id="panel">
    <resources>
      <stylesheet src="chrome://global/skin/notification.css"/>
    </resources>
    <content>
        <xul:panel anonid="panel" norestorefocus="true" noautofocus="true"
            ignorekeys="true" role="presentation" type="arrow" class="panel">
            <xul:hbox>
                <xul:vbox class="iconbox">
                    <xul:image src="chrome://firebug/skin/firebug64.png"/>
                </xul:vbox>
                <xul:vbox>
                    <xul:description anonid="desc" class="desc" />
                    <xul:hbox class="warningbox">
                        <xul:vbox>
                            <xul:spacer flex="1"/>
                            <xul:image src="chrome://firebug/skin/warning.svg" class="warningicon"/>
                            <xul:spacer flex="1"/>
                        </xul:vbox>
                        <xul:vbox>
                            <xul:description anonid="warning" class="warn" />
                        </xul:vbox>
                    </xul:hbox>
                    <xul:label anonid="learnMore"
                        class="text-link popup-notification-learnmore-link learnMore"
                        href="https://getfirebug.com/"/>
                    <xul:hbox align="right">
                        <xul:button anonid="upgrade" type="menu-button" oncommand="onUpgrade(event)"
                            class="popup-notification-menubutton">
                            <xul:menupopup>
                                <xul:menuitem anonid="disable" oncommand="onDisable(event)"/>
                            </xul:menupopup>
                        </xul:button>
                    </xul:hbox>

                </xul:vbox>
            </xul:hbox>
        </xul:panel>
    </content>

    <implementation>
        <constructor><![CDATA[
        ]]></constructor>

        <method name="internationalize">
            <parameter name="Locale" />
            <body><![CDATA[
                var desc = document.getAnonymousElementByAttribute(this, "anonid", "desc");
                desc.textContent = Locale.$STR("multiprocess.description");

                var warn = document.getAnonymousElementByAttribute(this, "anonid", "warning");
                warn.textContent = Locale.$STR("multiprocess.warning");

                var learnMore = document.getAnonymousElementByAttribute(this, "anonid", "learnMore");
                learnMore.textContent = Locale.$STR("multiprocess.learnMore");

                var upgradeButton = document.getAnonymousElementByAttribute(this, "anonid", "upgrade");
                upgradeButton.label = Locale.$STR("multiprocess.upgrade");

                var disableMenu = document.getAnonymousElementByAttribute(this, "anonid", "disable");
                disableMenu.label = Locale.$STR("multiprocess.disable");
            ]]></body>
        </method>

        <method name="open">
            <body><![CDATA[
                var panel = document.getAnonymousElementByAttribute(this, "anonid", "panel");
                var startButton = document.getElementById("firebug-button");
                var style = document.defaultView.getComputedStyle(startButton.button);
                var offsetY = parseInt(style["padding-bottom"]);
                var offsetX = parseInt(style["width"])/2;
                panel.openPopup(startButton.button, "after_end", -offsetX, -offsetY, false, false);
            ]]></body>
        </method>

        <method name="onDisable">
            <parameter name="event" />
            <body><![CDATA[
            event.stopPropagation();
            ]]></body>
        </method>

        <method name="onUpgrade">
            <parameter name="event" />
            <body><![CDATA[
            event.stopPropagation();
            ]]></body>
        </method>

    </implementation>

</binding>

</bindings>
